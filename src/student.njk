---
layout: layouts/base.njk
tags: studenterPages
pagination:
  data: studenter
  size: 1
  alias: student
  addAllPagesToCollections: true
permalink: "/student/{{(student.fnamn + '-' + student.enamn) | slug}}/"
---

{% set studentSlug = (student.fnamn + '-' + student.enamn) | slug %}
{% set
alster = student.alster() %}

{# small font triangle #}
{% import "macros/smol-tri.njk" as smol %}

<section id="personligsida" w:flex="~ col" w:grid="gap-s" w:p="y-xl" class="">

    {# tillbaka #}
    <a
        href="/"
        id="tillbaka"
        onclick="
        event.preventDefault()
        history.pushState('student',null,'/#{{ studentSlug }}')
        location.reload()">
        {{smol.tri()}}Tillbaka
    </a>

    {# student #}
    <div id="student-wrapper" w:flex="grow" w:grid="gap-2xs">

        {# namn #}
        <h2 w:md="col-start-2 row-start-1" w:grid="col-start-1">
            {{ student.fnamn }}
            {{ student.enamn }}
        </h2>

        {# portrait #}
        {% if build.env == "production" %}
            <div
            style="aspect-ratio: 1/1"
            w:w="full"
            w:object="cover"
            w:md="col-start-1 row-start-1 row-span-3 " 
            >
                {% image 'alster',
                studentSlug + '/' + 'portrait.png',
                "Porträtt av {{student.fnamn}} {{student.enamn}}",
                studentSlug %}
            </div>
        {% else %}
            <img  
            style="aspect-ratio: 1/1"
            w:w="full"
            w:object="cover"
            w:md="col-start-1 row-start-1 row-span-3 " 
            src="/assets/alster/{{studentSlug}}/portrait.png" 
            alt="Porträtt av {{student.fnamn}} {{student.enamn}} med en triangel som bakgrund"/>
        {% endif %}

        {# beskrivning #}
        <p w:md="col-start-2 row-start-2" w:m="b-l">{{ student.beskrivning }}</p>

        {# TODO fix grid row height #}
        {# alster #}
        <ul  id="alster-wrapper" w:grid="gap-3xs" w:md="row-start-3 col-start-2 row-span-3" aria-hidden="true"

        {# nav handler #}
        onclick="
            const vid = event.target.nextElementSibling?.querySelector('video')||event.target.previousElementSibling?.querySelector('video')
        vid?.paused&&vid?.play()
        if(event.target.id === 'close'){
            event.preventDefault()
            history.back()
            if(vid){vid.currentTime = 0;vid.pause()}
        }else if(event.target.tagName === 'A'){
            if(event.target.getAttribute('nav') == 'replace'){
                event.preventDefault()
                location.replace(event.target.href)
            }
        }
        ">
            {% for alst in alster %}
                {% set isVideo = '.mov' in alst or '.mp4' in alst %}

                <li w:pos="relative" id="alster{{loop.index}}">
                    <a  href="#alster{{loop.index}}" w:pos="absolute" w:w="full" w:h="full" ></a>
                    <div >
                        {% if isVideo %}
                            <video controls w:cursor="pointer" src="/assets/{{alst}}" alt="Ett alster"></video>
                        {% else %}
                            {% if build.env == 'production' %}
                                {% image '',
                                alst,
                                "Ett alster",
                                studentSlug %}
                            {% else %}
                                <img  src="/assets/{{ alst }}" alt="Ett alster"/>
                            {% endif %}
                        {% endif %}
                    </div>
                    <a id="close" href="#" w:pos="absolute right-2xs top-2xs"  style="z-index: 2000;font-size: calc(var(--step-3) * 2);" w:font="leading-[0.8ex]" w:display="hidden">&Cross;</a>
                    <nav w:p="x-3xs3xl" w:display="hidden" w:pos="absolute top-[50%] left-[0]" w:w="full" w:justify="between">
                        {% if loop.index != 1 %}
                            <a w:text="xl middle center" nav="replace" href="#alster{{loop.index - 1}}">{{smol.tri(m=0)}}</a>
                        {% endif %}
                        {% if loop.index != (alster | length) %}
                            <a w:text="xl middle center" nav="replace" class="{{'ml-auto' if loop.index == 1 else ""}}" href="#alster{{loop.index + 1}}">{{smol.tri(r=180,m=0)}}</a>
                        {% endif %}
                    </nav>
                </li>
            {% endfor %}
        </ul>

        {# länkar #}
        {% set links = student.links %}
        {% if links | gotLinks %}

            <div id="socials" w:md="col-start-1 row-start-4">

                {# socials #}
                {% for name, href in links | socials %}
                    {% if href %}
                        <a w:text="underline underline-1" w:m="r-xs" href="{{ href }}">{{ name }}</a>
                    {% endif %}
                {% endfor %}

                {# hemsida #}
                {% if links.hemsida %}
                    <br/>
                    <span>hemsida {{smol.tri(r=180)}}
                        <a w:text="underline-1 underline" href="{{ links.hemsida }}">{{links.hemsida}}</a>
                    </span>
                {% endif %}
            {% endif %}

        </div>
    </div>

    {# nav #}
    <nav w:w="full" w:flex="~" w:justify="between">

        {% if pagination.href.previous %}
            <a href="{{ pagination.href.previous }}">
                {{smol.tri()}} Föregående</a>
        {% endif %}

        {% if pagination.href.next %}
            <a href="{{ pagination.href.next }}" class="{{'ml-auto' if not pagination.href.previous else ""}}">Nästa {{smol.tri(r=180)}}</a>
        {% endif %}
    </nav>
</section>